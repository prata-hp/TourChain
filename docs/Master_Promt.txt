You are assisting the team working on **TourChain**, a Smart India Hackathon project.

## ğŸ”¹ Repo structure
Root: TourChain/
  â”œâ”€â”€ backend/
  â”‚     â”œâ”€â”€ contracts/          # Solidity contracts (TouristRegistry.sol etc.)
  â”‚     â”œâ”€â”€ scripts/            # Hardhat deploy scripts
  â”‚     â”œâ”€â”€ models/             # Mongoose schemas
  â”‚     â”œâ”€â”€ controllers/        # Express business logic
  â”‚     â”œâ”€â”€ routes/             # API routes
  â”‚     â”œâ”€â”€ middlewares/        # JWT auth, validation
  â”‚     â”œâ”€â”€ utils/              # blockchain.js, helpers
  â”‚     â”œâ”€â”€ seed/               # dev seed data
  â”‚     â”œâ”€â”€ index.js            # entry point
  â”‚     â””â”€â”€ .env.example
  â”œâ”€â”€ frontend/
  â”‚     â”œâ”€â”€ tourist/            # Tourist UI (Sambhas)
  â”‚     â””â”€â”€ admin/              # Admin dashboard (Shreya)
  â””â”€â”€ README.md

## ğŸ”¹ Roles
- **Anupam** â†’ Database + Backend core
- **You (Nitish)** â†’ Blockchain + Backend bridge
- **Sambhas** â†’ Tourist frontend
- **Shreya** â†’ Admin dashboard
- **Archana** â†’ UI/UX polish

## ğŸ”¹ Database models (Mongoose)
- **Tourist**: { name, email, phone, walletAddress [unique], idType, idHash, photoUrl, verified, verificationTxHash, createdAt, updatedAt }
- **PanicCall**: { tourist, location { lon,lat }, message, status, adminNotified, createdAt } (with geospatial index)
- **Admin**: { name, email [unique], passwordHash, role }
- **VerificationLog**: { tourist, admin, action, dataHash, txHash, createdAt }

## ğŸ”¹ Endpoints (Express APIs, mounted under `/api`)
### Tourist (frontend by Sambhas)
- `POST /api/tourists/register` â†’ register tourist, save to DB, hash IDs.
- `GET /api/tourists/:id` or `/wallet/:walletAddress` â†’ fetch profile.
- `POST /api/panic` â†’ raise panic, save to DB, emit socket event.

### Admin (frontend by Shreya, JWT required)
- `POST /api/admin/login` â†’ returns JWT.
- `GET /api/admin/tourists` â†’ list tourists (filter verified/unverified).
- `GET /api/admin/tourists/:id` â†’ tourist details + logs.
- `PUT /api/admin/tourists/:id/verify` â†’ verify tourist:
   1. Update DB (`verified: true`).
   2. Call blockchain util (`recordVerification(dataHash)`).
   3. Store txHash in tourist + VerificationLog.
- `GET /api/admin/panic` â†’ list panic calls.
- `PUT /api/admin/panic/:id/resolve` â†’ resolve panic.
- `GET /api/stats/admin` â†’ aggregation for dashboard widgets.

### Real-time
- Panic calls also emit `socket.io` event: `panic:new`.

## ğŸ”¹ Blockchain (backend/utils/blockchain.js)
- Uses ethers.js + Hardhat artifacts.
- Function: `recordVerification(dataHash)` â†’ calls smart contract, returns txHash.
- Called only from **Admin verify endpoint** in prototype.

## ğŸ”¹ Prototype rules (important!)
- **DB = full source of data.**
- **Blockchain = only verification proofs.**
- **Panic calls = DB only.**
- **AI safety score = off-chain, stored in DB.**

## ğŸ”¹ Expectations for this AI session
- Always respect this repo structure, endpoints, and contracts.
- Never invent random folders or endpoints outside this spec.
- When asked for code, generate files exactly where they belong.
- Sync backend (Anupam/Nitish) with frontend (Sambhas/Shreya).
- Always clarify whether the code is for prototype or long-term.











































































2ND  iteration

Perfect ğŸ‘ Iâ€™ll extend your master prompt so that **Sambhasâ€™ tourist frontend** is fully covered.
Iâ€™ll add a **Frontendâ€“Backend contract** section for Tourist flows (register, AI summary, panic), and edit your structure slightly so Sambhas has **no guesswork** about payloads and responses.

Hereâ€™s the **edited master prompt** â¬‡ï¸

---

# ğŸ”¹ Master Prompt (Updated with Tourist Frontend)

You are assisting the team working on **TourChain**, a Smart India Hackathon project.

---

## ğŸ”¹ Repo structure

```
Root: TourChain/
  â”œâ”€â”€ backend/
  â”‚     â”œâ”€â”€ contracts/          # Solidity contracts (TouristRegistry.sol etc.)
  â”‚     â”œâ”€â”€ scripts/            # Hardhat deploy scripts
  â”‚     â”œâ”€â”€ models/             # Mongoose schemas
  â”‚     â”œâ”€â”€ controllers/        # Express business logic
  â”‚     â”œâ”€â”€ routes/             # API routes
  â”‚     â”œâ”€â”€ middlewares/        # JWT auth, validation
  â”‚     â”œâ”€â”€ utils/              # blockchain.js, helpers
  â”‚     â”œâ”€â”€ seed/               # dev seed data
  â”‚     â”œâ”€â”€ index.js            # entry point
  â”‚     â””â”€â”€ .env.example
  â”œâ”€â”€ frontend/
  â”‚     â”œâ”€â”€ tourist/            # Tourist UI (Sambhas)
  â”‚     â””â”€â”€ admin/              # Admin dashboard (Shreya)
  â””â”€â”€ README.md
```

---

## ğŸ”¹ Roles

* **Anupam** â†’ Database + Backend core
* **You (Nitish)** â†’ Blockchain + Backend bridge
* **Sambhas** â†’ Tourist frontend
* **Shreya** â†’ Admin dashboard
* **Archana** â†’ UI/UX polish

---

## ğŸ”¹ Database models (Mongoose)

* **Tourist**: `{ name, email, phone, walletAddress [unique], idType, idHash, photoUrl, verified, verificationTxHash, createdAt, updatedAt }`
* **PanicCall**: `{ tourist, location { lon,lat }, message, status, adminNotified, createdAt }` (with geospatial index)
* **Admin**: `{ name, email [unique], passwordHash, role }`
* **VerificationLog**: `{ tourist, admin, action, dataHash, txHash, createdAt }`

---

## ğŸ”¹ Endpoints (Express APIs, mounted under `/api`)

### **Tourist (frontend by Sambhas)**

* `POST /api/tourists/register`
  â†’ Register tourist, save to DB, hash IDs.
* `GET /api/tourists/:id` or `/wallet/:walletAddress`
  â†’ Fetch profile.
* `POST /api/panic`
  â†’ Raise panic, save to DB, emit socket event.
* `POST /api/ai-summary`
  â†’ (Prototype only) Send itinerary & trip details â†’ return AI safety score + summary (stored in DB).

### **Admin (frontend by Shreya, JWT required)**

* `POST /api/admin/login` â†’ returns JWT.
* `GET /api/admin/tourists` â†’ list tourists (filter verified/unverified).
* `GET /api/admin/tourists/:id` â†’ tourist details + logs.
* `PUT /api/admin/tourists/:id/verify` â†’ verify tourist (DB + blockchain + log).
* `GET /api/admin/panic` â†’ list panic calls.
* `PUT /api/admin/panic/:id/resolve` â†’ resolve panic.
* `GET /api/stats/admin` â†’ aggregation for dashboard widgets.

### **Real-time**

* Panic calls also emit `socket.io` event: `panic:new`.

---

## ğŸ”¹ Blockchain (backend/utils/blockchain.js)

* Uses **ethers.js** + Hardhat artifacts.
* Function: `recordVerification(dataHash)` â†’ calls smart contract, returns txHash.
* Called only from **Admin verify endpoint** in prototype.
* **Rule:** Only hashes go on-chain. All full data stays in DB.

---

## ğŸ”¹ Prototype rules (important!)

* **DB = full source of data.**
* **Blockchain = only verification proofs.**
* **Panic calls = DB only.**
* **AI safety score = off-chain, stored in DB.**

---

## ğŸ”¹ Tourist Frontend (Sambhas)

### Tourist Registration Flow

1. Tourist fills form (fields: `name, email, phone, walletAddress, idType, idFileUpload, itinerary, startDate, endDate, location {lat,lng}`).
2. Frontend **hashes ID file** before sending (`idHash`). File may be uploaded â†’ backend returns `photoUrl`.
3. Frontend calls `/api/ai-summary` first:

   ```json
   POST /api/ai-summary
   {
     "itinerary": "Delhi â†’ Jaipur â†’ Agra",
     "startDate": "2025-09-10",
     "endDate": "2025-09-20",
     "lat": 28.61,
     "lng": 77.23
   }
   ```

   **Response:**

   ```json
   {
     "safetyScore": 82,
     "summary": "Trip covers safe urban regions. Moderate crowding expected.",
     "dataHash": "0xabc123..."
   }
   ```
4. Frontend then calls `/api/tourists/register`:

   ```json
   POST /api/tourists/register
   {
     "name": "Alice",
     "email": "alice@mail.com",
     "phone": "+91xxxxxxxx",
     "walletAddress": "0x1234...",
     "idType": "Passport",
     "idHash": "0xdeadbeef...",
     "photoUrl": "/uploads/photo.png",
     "aiSummary": "Trip covers safe urban regions...",
     "safetyScore": 82,
     "dataHash": "0xabc123..."
   }
   ```

   **Response:**

   ```json
   {
     "touristId": "64f123...",
     "verified": false,
     "createdAt": "2025-09-04T09:00:00Z"
   }
   ```

### Panic Flow

```json
POST /api/panic
{
  "touristId": "64f123...",
  "location": { "lat": 28.61, "lon": 77.23 },
  "message": "Lost near Red Fort"
}
```

**Response:**

```json
{
  "panicId": "77a9...",
  "status": "active",
  "adminNotified": true
}
```

---

## ğŸ”¹ .env.example (minimum keys)

```
MONGO_URI=mongodb://localhost:27017/tourchain
JWT_SECRET=your_jwt_secret
BLOCKCHAIN_RPC=https://sepolia.infura.io/v3/...
PRIVATE_KEY=0xabc123...
AI_API_KEY=sk-xxxx
```

---

âœ… With this, Sambhas knows exactly:

* What payloads to send,
* Which endpoints exist,
* What responses to expect.

This eliminates inconsistencies between frontend â†” backend.

---





























































































3rd iteration


Perfect â€” hereâ€™s the **merged master prompt** with **airtight contracts for both Sambhas (Tourist frontend)** and **Shreya (Admin frontend)**.
Iâ€™ve slotted the **Admin Frontend section** right after the Tourist section, so the flow stays clean and symmetric.

---

# ğŸ”¹ Master Prompt (Updated with Tourist + Admin Frontend)

You are assisting the team working on **TourChain**, a Smart India Hackathon project.

---

## ğŸ”¹ Repo structure

```
Root: TourChain/
  â”œâ”€â”€ backend/
  â”‚     â”œâ”€â”€ contracts/          # Solidity contracts (TouristRegistry.sol etc.)
  â”‚     â”œâ”€â”€ scripts/            # Hardhat deploy scripts
  â”‚     â”œâ”€â”€ models/             # Mongoose schemas
  â”‚     â”œâ”€â”€ controllers/        # Express business logic
  â”‚     â”œâ”€â”€ routes/             # API routes
  â”‚     â”œâ”€â”€ middlewares/        # JWT auth, validation
  â”‚     â”œâ”€â”€ utils/              # blockchain.js, helpers
  â”‚     â”œâ”€â”€ seed/               # dev seed data
  â”‚     â”œâ”€â”€ index.js            # entry point
  â”‚     â””â”€â”€ .env.example
  â”œâ”€â”€ frontend/
  â”‚     â”œâ”€â”€ tourist/            # Tourist UI (Sambhas)
  â”‚     â””â”€â”€ admin/              # Admin dashboard (Shreya)
  â””â”€â”€ README.md
```

---

## ğŸ”¹ Roles

* **Anupam** â†’ Database + Backend core
* **You (Nitish)** â†’ Blockchain + Backend bridge
* **Sambhas** â†’ Tourist frontend
* **Shreya** â†’ Admin dashboard
* **Archana** â†’ UI/UX polish

---

## ğŸ”¹ Database models (Mongoose)

* **Tourist**: `{ name, email, phone, walletAddress [unique], idType, idHash, photoUrl, verified, verificationTxHash, createdAt, updatedAt }`
* **PanicCall**: `{ tourist, location { lon,lat }, message, status, adminNotified, createdAt }` (with geospatial index)
* **Admin**: `{ name, email [unique], passwordHash, role }`
* **VerificationLog**: `{ tourist, admin, action, dataHash, txHash, createdAt }`

---

## ğŸ”¹ Endpoints (Express APIs, mounted under `/api`)

### **Tourist (frontend by Sambhas)**

* `POST /api/tourists/register` â†’ register tourist, save to DB, hash IDs.
* `GET /api/tourists/:id` or `/wallet/:walletAddress` â†’ fetch profile.
* `POST /api/panic` â†’ raise panic, save to DB, emit socket event.
* `POST /api/ai-summary` â†’ (prototype only) send itinerary & trip details â†’ return AI safety score + summary (stored in DB).

### **Admin (frontend by Shreya, JWT required)**

* `POST /api/admin/login` â†’ returns JWT.
* `GET /api/admin/tourists` â†’ list tourists (filter verified/unverified).
* `GET /api/admin/tourists/:id` â†’ tourist details + logs.
* `PUT /api/admin/tourists/:id/verify` â†’ verify tourist (DB + blockchain + log).
* `GET /api/admin/panic` â†’ list panic calls.
* `PUT /api/admin/panic/:id/resolve` â†’ resolve panic.
* `GET /api/stats/admin` â†’ aggregation for dashboard widgets.

### **Real-time**

* Panic calls also emit `socket.io` event: `panic:new`.

---

## ğŸ”¹ Blockchain (backend/utils/blockchain.js)

* Uses **ethers.js** + Hardhat artifacts.
* Function: `recordVerification(dataHash)` â†’ calls smart contract, returns txHash.
* Called only from **Admin verify endpoint** in prototype.
* **Rule:** Only hashes go on-chain. All full data stays in DB.

---

## ğŸ”¹ Prototype rules (important!)

* **DB = full source of data.**
* **Blockchain = only verification proofs.**
* **Panic calls = DB only.**
* **AI safety score = off-chain, stored in DB.**

---

## ğŸ”¹ Tourist Frontend (Sambhas)

### Tourist Registration Flow

1. Tourist fills form (`name, email, phone, walletAddress, idType, idFileUpload, itinerary, startDate, endDate, location {lat,lng}`).
2. Frontend hashes ID before sending (`idHash`). Backend stores file and returns `photoUrl`.
3. Frontend calls `/api/ai-summary`:

```json
POST /api/ai-summary
{
  "itinerary": "Delhi â†’ Jaipur â†’ Agra",
  "startDate": "2025-09-10",
  "endDate": "2025-09-20",
  "lat": 28.61,
  "lng": 77.23
}
```

**Response:**

```json
{
  "safetyScore": 82,
  "summary": "Trip covers safe urban regions. Moderate crowding expected.",
  "dataHash": "0xabc123..."
}
```

4. Then call `/api/tourists/register`:

```json
POST /api/tourists/register
{
  "name": "Alice",
  "email": "alice@mail.com",
  "phone": "+91xxxxxxxx",
  "walletAddress": "0x1234...",
  "idType": "Passport",
  "idHash": "0xdeadbeef...",
  "photoUrl": "/uploads/photo.png",
  "aiSummary": "Trip covers safe urban regions...",
  "safetyScore": 82,
  "dataHash": "0xabc123..."
}
```

**Response:**

```json
{
  "touristId": "64f123...",
  "verified": false,
  "createdAt": "2025-09-04T09:00:00Z"
}
```

---

### Panic Flow

```json
POST /api/panic
{
  "touristId": "64f123...",
  "location": { "lat": 28.61, "lon": 77.23 },
  "message": "Lost near Red Fort"
}
```

**Response:**

```json
{
  "panicId": "77a9...",
  "status": "active",
  "adminNotified": true
}
```

---

## ğŸ”¹ Admin Frontend (Shreya)

### 1. Login

```json
POST /api/admin/login
{
  "email": "shreya@tourchain.gov",
  "password": "mypassword"
}
```

**Response:**

```json
{
  "token": "eyJhbGciOiJIUzI1...",
  "admin": { "id": "adm123", "name": "Shreya", "role": "superadmin" }
}
```

â¡ï¸ Store `token` in localStorage, send as `Authorization: Bearer <token>`.

---

### 2. List Tourists

```http
GET /api/admin/tourists
```

**Response:**

```json
[
  {
    "id": "64f123...",
    "name": "Alice",
    "email": "alice@mail.com",
    "phone": "+91xxxxxxxx",
    "walletAddress": "0x1234...",
    "verified": false,
    "safetyScore": 82,
    "aiSummary": "Trip covers safe urban regions...",
    "createdAt": "2025-09-04T09:00:00Z"
  }
]
```

---

### 3. Get Tourist Details

```http
GET /api/admin/tourists/:id
```

**Response:**

```json
{
  "id": "64f123...",
  "name": "Alice",
  "email": "alice@mail.com",
  "phone": "+91xxxxxxxx",
  "walletAddress": "0x1234...",
  "verified": false,
  "photoUrl": "/uploads/alice.png",
  "aiSummary": "Trip covers safe urban regions...",
  "safetyScore": 82,
  "verificationLogs": [
    {
      "admin": "Anupam",
      "action": "verify",
      "txHash": "0xabc123...",
      "timestamp": "2025-09-04T10:00:00Z"
    }
  ]
}
```

---

### 4. Verify Tourist

```http
PUT /api/admin/tourists/:id/verify
{
  "adminId": "adm123"
}
```

**Response:**

```json
{
  "id": "64f123...",
  "verified": true,
  "verificationTxHash": "0xabc123...",
  "updatedAt": "2025-09-04T10:05:00Z"
}
```

---

### 5. List Panic Calls

```http
GET /api/admin/panic
```

**Response:**

```json
[
  {
    "panicId": "77a9...",
    "tourist": { "id": "64f123...", "name": "Alice" },
    "location": { "lat": 28.61, "lon": 77.23 },
    "message": "Lost near Red Fort",
    "status": "active",
    "createdAt": "2025-09-04T09:30:00Z"
  }
]
```

---

### 6. Resolve Panic

```http
PUT /api/admin/panic/:id/resolve
```

**Response:**

```json
{
  "panicId": "77a9...",
  "status": "resolved",
  "updatedAt": "2025-09-04T09:45:00Z"
}
```

---

### 7. Dashboard Stats

```http
GET /api/stats/admin
```

**Response:**

```json
{
  "totalTourists": 120,
  "verifiedTourists": 85,
  "activePanics": 3,
  "avgSafetyScore": 74
}
```

---

### 8. Real-time Panic Alerts

**Socket.io event:**
`panic:new`

**Payload:**

```json
{
  "panicId": "77a9...",
  "tourist": { "id": "64f123...", "name": "Alice" },
  "location": { "lat": 28.61, "lon": 77.23 },
  "message": "Lost near Red Fort",
  "status": "active",
  "createdAt": "2025-09-04T09:30:00Z"
}
```

â¡ï¸ Rule: use socket listener first; fallback: poll `/api/admin/panic` every 30s.

---

## ğŸ”¹ .env.example (minimum keys)

```
MONGO_URI=mongodb://localhost:27017/tourchain
JWT_SECRET=your_jwt_secret
BLOCKCHAIN_RPC=https://sepolia.infura.io/v3/...
PRIVATE_KEY=0xabc123...
AI_API_KEY=sk-xxxx
```

---

âœ… Now both **Sambhas (Tourist)** and **Shreya (Admin)** have airtight contracts, payloads, responses, and real-time flows.
No guesswork across the team â†’ fully consistent repo.

---

Would you like me to also add a **Frontend folder structure breakdown** (showing exactly what files Sambhas and Shreya should have in their respective folders) so this becomes *truly plug & play*?





















































Final Iteration


Perfect ğŸ‘Œ Got it. Iâ€™ll rewrite the **Master Prompt** into its **final, consistent version**, fixing all the contradictions and adding your preferences:

* **No MetaMask** â†’ use Aadhaar / Passport number instead of wallet.
* **Admin login** â†’ seeded with email + password in DB.
* **Itinerary** â†’ supports multiple places (array).
* **JWT** â†’ explained as session pass.
* **No sockets** â†’ use polling.
* **Blockchain write** â†’ happens when tourist *starts journey*, valid until *end date*.
* **Backend recomputes hashes** (never trusts client).
* **Checkpoints postponed** (not needed in Round-1).

Hereâ€™s the final:

---

# ğŸ”¹ Final Master Prompt (TourChain Prototype)

You are assisting the team working on **TourChain**, a Smart India Hackathon project.
This prompt ensures **zero contradictions** across frontend, backend, blockchain, and AI.

---

## ğŸ”¹ Repo structure

```
Root: TourChain/
  â”œâ”€â”€ backend/
  â”‚     â”œâ”€â”€ contracts/          # Solidity contracts (TouristRegistry.sol etc.)
  â”‚     â”œâ”€â”€ scripts/            # Hardhat deploy scripts
  â”‚     â”œâ”€â”€ models/             # Mongoose schemas
  â”‚     â”œâ”€â”€ controllers/        # Express business logic
  â”‚     â”œâ”€â”€ routes/             # API routes
  â”‚     â”œâ”€â”€ middlewares/        # JWT auth, validation
  â”‚     â”œâ”€â”€ utils/              # blockchain.js, helpers
  â”‚     â”œâ”€â”€ seed/               # dev seed data (admins)
  â”‚     â”œâ”€â”€ index.js            # entry point
  â”‚     â””â”€â”€ .env.example
  â”œâ”€â”€ frontend/
  â”‚     â”œâ”€â”€ tourist/            # Tourist UI (Sambhas)
  â”‚     â””â”€â”€ admin/
        â”œâ”€â”€ pages/
  â”‚     â”œâ”€â”€ Login.jsx            # Admin login page
  â”‚     â”œâ”€â”€ Dashboard.jsx        # Stats (total tourists, active journeys, panic count)
  â”‚     â”œâ”€â”€ Tourists.jsx         # List of tourists
  â”‚     â”œâ”€â”€ TouristDetails.jsx   # Tourist details page
  â”‚     â”œâ”€â”€ Panics.jsx           # List of panic alerts
  â”‚     â””â”€â”€ PanicDetails.jsx     # Individual panic view + resolve button
  â”œâ”€â”€ components/
  â”‚     â”œâ”€â”€ Sidebar.jsx
  â”‚     â”œâ”€â”€ Navbar.jsx
  â”‚     â”œâ”€â”€ CardWidget.jsx       # Small dashboard cards
  â”‚     â””â”€â”€ Table.jsx            # Reusable table
  â”œâ”€â”€ services/
  â”‚     â””â”€â”€ api.js
  â”œâ”€â”€ App.jsx
  â””â”€â”€ index.js

  â””â”€â”€ README.md
```

---

## ğŸ”¹ Roles

* **Anupam** â†’ Database + Backend core
* **You (Nitish)** â†’ Blockchain + Backend bridge
* **Sambhas** â†’ Tourist frontend
* **Shreya** â†’ Admin dashboard
* **Archana** â†’ UI/UX polish

---

## ğŸ”¹ Database models (Mongoose)

* **Tourist**:

  ```js
  { 
    name, 
    email, 
    phone, 
    idType,            // Aadhaar / Passport
    idNumberHash,      // hash of Aadhaar/Passport
    photoUrl, 
    itinerary: [String], 
    startDate, 
    endDate, 
    verified, 
    verificationTxHash, 
    createdAt, 
    updatedAt 
  }
  ```

* **PanicCall**:

  ```js
  { 
    tourist, 
    location { lon,lat }, 
    message, 
    status, 
    adminNotified, 
    createdAt 
  }
  ```

* **Admin**:

  ```js
  { name, email [unique], passwordHash, role }
  ```

  (Seeded in DB, e.g. Shreyaâ€™s account)

* **VerificationLog**:

  ```js
  { tourist, admin, action, dataHash, txHash, createdAt }
  ```

---

## ğŸ”¹ Endpoints (Express APIs, mounted under `/api`)

### **Tourist (frontend by Sambhas)**

* `POST /api/tourists/register`
  â†’ register tourist, save to DB, recompute ID hash on backend.

* `GET /api/tourists/:id`
  â†’ fetch profile.

* `POST /api/panic`
  â†’ raise panic, save to DB.

* `POST /api/tourists/:id/startJourney`
  â†’ tourist clicks â€œStart Journeyâ€, backend writes a blockchain record with `{ idHash, startDate, endDate }`.

* `POST /api/ai-summary` (Round-1 only)
  â†’ AI safety score & summary triggered **after save** (frontend stays simple).

---

### **Admin (frontend by Shreya, JWT required)**

* `POST /api/admin/login` â†’ login with email + password, return JWT.
* `GET /api/admin/tourists` â†’ list all tourists.
* `GET /api/admin/tourists/:id` â†’ tourist details + journey + logs.
* `PUT /api/admin/tourists/:id/verify` â†’ (future) verify tourist, record on blockchain.
* `GET /api/admin/panic` â†’ list panic calls.
* `PUT /api/admin/panic/:id/resolve` â†’ resolve panic.
* `GET /api/stats/admin` â†’ simple dashboard stats.

---

## ğŸ”¹ Blockchain (backend/utils/blockchain.js)

* Uses **ethers.js** + Hardhat.
* Function: `recordJourney(idHash, startDate, endDate)` â†’ writes hash + validity period on-chain.
* Backend **always recomputes** `idHash` before sending to blockchain.
* Blockchain = only for **journey proofs** (no personal data).

---

## ğŸ”¹ Prototype rules (Round-1)

* **DB = main source** of all data.
* **Blockchain = only journey proofs** (idHash + dates).
* **Panic calls = DB only.**
* **AI score = off-chain, stored in DB.**
* **No sockets** â†’ use polling for panic alerts.
* **Checkpoints postponed.**

---

## ğŸ”¹ Tourist Frontend (Sambhas)

### Tourist Registration Flow

1. Tourist fills form:

   ```
   name, email, phone, idType, idNumber, idFileUpload, itinerary[], 
   startDate, endDate, location {lat,lng}
   ```

   (Itinerary supports multiple places via â€œ+ Add Placeâ€ button).

2. Frontend **sends plain data**. Backend computes `idNumberHash`, stores file, returns `photoUrl`.

3. Backend auto-triggers `/api/ai-summary` after save.

---

### Panic Flow

```json
POST /api/panic
{
  "touristId": "64f123...",
  "location": { "lat": 28.61, "lon": 77.23 },
  "message": "Lost near Red Fort"
}
```

---

### Start Journey Flow (Blockchain write)

```http
POST /api/tourists/:id/startJourney
```

**Response:**

```json
{
  "touristId": "64f123...",
  "journeyStatus": "active",
  "verificationTxHash": "0xabc123...",
  "validUntil": "2025-09-20"
}
```

---

## ğŸ”¹ Admin Frontend (Shreya)

### Login

```json
POST /api/admin/login
{
  "email": "shreya@tourchain.gov",
  "password": "mypassword"
}
```

Response = JWT token (digital session pass).

---

### Tourist Management

* List tourists â†’ `/api/admin/tourists`
* Get details â†’ `/api/admin/tourists/:id`
* See journeys (startDateâ€“endDate, blockchain txHash).

---

### Panic Management

* List panics â†’ `/api/admin/panic`
* Resolve â†’ `/api/admin/panic/:id/resolve`

---

### Dashboard Stats

```json
{
  "totalTourists": 120,
  "activeJourneys": 40,
  "activePanics": 3,
  "avgSafetyScore": 74
}
```

---

## ğŸ”¹ .env.example

```
MONGO_URI=mongodb://localhost:27017/tourchain
JWT_SECRET=your_jwt_secret
BLOCKCHAIN_RPC=https://sepolia.infura.io/v3/...
PRIVATE_KEY=0xabc123...
AI_API_KEY=sk-xxxx
```

---

âœ… Now:

* Tourists identified by **Aadhaar/Passport** (hashed).
* Admins login with **email + password**.
* Blockchain only for **journey proof (startâ€“end dates)**.
* AI runs **in backend after save**.
* No sockets, polling only.
* Frontend has clear flows with **itinerary array input**.

---

Do you want me to also add a **Frontend folder breakdown** (showing what Sambhas & Shreya must create: pages, components, forms, etc.), so nobody in your team guesses folder structure?








































































1st Round Ultimate Prompt [in Use]
Perfect âœ…
Let me now rewrite the **Master Prompt (Lightweight Version)** so your team can build the **Round-1 prototype hassle-free**.

---

# ğŸ”¹ Final Lightweight Master Prompt (TourChain Prototype â€“ HTML/JS Frontend)

You are assisting the team working on **TourChain**, a Smart India Hackathon project.
This version keeps the frontend **simple HTML + CSS + JavaScript** (no React), while backend + blockchain remain Node/Express/Mongo.

---

## ğŸ”¹ Repo structure

```
Root: TourChain/
  â”œâ”€â”€ backend/
  â”‚     â”œâ”€â”€ contracts/          # Solidity contracts (TouristRegistry.sol etc.)
  â”‚     â”œâ”€â”€ scripts/            # Hardhat deploy scripts
  â”‚     â”œâ”€â”€ models/             # Mongoose schemas
  â”‚     â”œâ”€â”€ controllers/        # Express business logic
  â”‚     â”œâ”€â”€ routes/             # API routes
  â”‚     â”œâ”€â”€ middlewares/        # JWT auth, validation
  â”‚     â”œâ”€â”€ utils/              # blockchain.js, helpers
  â”‚     â”œâ”€â”€ seed/               # dev seed data (admins)
  â”‚     â”œâ”€â”€ index.js            # entry point
  â”‚     â””â”€â”€ .env.example
  â”œâ”€â”€ frontend/
  â”‚     â”œâ”€â”€ tourist/
  â”‚     â”‚     â”œâ”€â”€ index.html        # Registration form
  â”‚     â”‚     â”œâ”€â”€ journey.html      # Start Journey page
  â”‚     â”‚     â”œâ”€â”€ panic.html        # Panic button page
  â”‚     â”‚     â”œâ”€â”€ style.css
  â”‚     â”‚     â””â”€â”€ app.js            # fetch() calls to backend
  â”‚     â””â”€â”€ admin/
  â”‚           â”œâ”€â”€ login.html        # Admin login
  â”‚           â”œâ”€â”€ dashboard.html    # Stats (counts)
  â”‚           â”œâ”€â”€ tourists.html     # List of tourists
  â”‚           â”œâ”€â”€ tourist.html      # Single tourist details
  â”‚           â”œâ”€â”€ panics.html       # List of panic alerts
  â”‚           â”œâ”€â”€ style.css
  â”‚           â””â”€â”€ app.js            # handles JWT + fetch() calls
  â””â”€â”€ README.md
```

---

## ğŸ”¹ Roles

* **Anupam** â†’ Database + Backend core
* **Nitish** â†’ Blockchain + Backend bridge
* **Sambhas** â†’ Tourist frontend (HTML/JS)
* **Shreya** â†’ Admin dashboard (HTML/JS)
* **Archana** â†’ UI/UX polish (CSS, layout)

---

## ğŸ”¹ Database models (Mongoose)

**Tourist**

```js
{ 
  name, 
  email, 
  phone, 
  idType,            // Aadhaar / Passport
  idNumberHash,      // hashed securely
  photoUrl, 
  itinerary: [String], 
  startDate, 
  endDate, 
  verified, 
  verificationTxHash, 
  createdAt, 
  updatedAt 
}
```

**PanicCall**

```js
{ 
  tourist, 
  location: { lon, lat }, 
  message, 
  status, 
  adminNotified, 
  createdAt 
}
```

**Admin**

```js
{ name, email [unique], passwordHash, role }
```

(Seed at least 1 admin: Shreya)

**VerificationLog**

```js
{ tourist, admin, action, dataHash, txHash, createdAt }
```

---

## ğŸ”¹ Endpoints (Express APIs under `/api`)

### Tourist (Sambhas frontend)

* `POST /api/tourists/register` â†’ register tourist.
* `GET /api/tourists/:id` â†’ get profile.
* `POST /api/panic` â†’ raise panic.
* `POST /api/tourists/:id/startJourney` â†’ start journey â†’ blockchain write.
* `POST /api/ai-summary` â†’ AI score (auto-triggered by backend).

### Admin (Shreya frontend, JWT required)

* `POST /api/admin/login` â†’ login (email + password).
* `GET /api/admin/tourists` â†’ list tourists.
* `GET /api/admin/tourists/:id` â†’ tourist details.
* `PUT /api/admin/tourists/:id/verify` â†’ (future) verify.
* `GET /api/admin/panic` â†’ list panic calls.
* `PUT /api/admin/panic/:id/resolve` â†’ resolve panic.
* `GET /api/stats/admin` â†’ dashboard counts.

---

## ğŸ”¹ Blockchain (backend/utils/blockchain.js)

* Uses **ethers.js + Hardhat**.
* `recordJourney(idHash, startDate, endDate)` â†’ writes to chain.
* Backend **always recomputes hash**, never trusts client.
* Blockchain stores only **journey proof (idHash + dates)**.

---

## ğŸ”¹ Prototype rules (Round-1)

* **DB = main source of truth**.
* **Blockchain = only journey proof (start & end dates)**.
* **AI = off-chain, stored in DB, triggered by backend**.
* **Panic calls = DB only**.
* **No sockets â†’ use polling every 10s**.
* **Checkpoints postponed**.

---

## ğŸ”¹ Tourist Frontend (HTML/JS by Sambhas)

**Registration Page (`index.html`)**

* Fields: name, email, phone, Aadhaar/Passport, upload photo, startDate, endDate.
* Button â€œ+ Add Placeâ€ â†’ JS adds more inputs â†’ itinerary array.
* On submit â†’ `fetch('/api/tourists/register', { method:'POST', body:JSON.stringify(formData) })`.

**Start Journey (`journey.html`)**

* Button â†’ calls `/api/tourists/:id/startJourney`.
* Shows blockchain txHash + validUntil.

**Panic Page (`panic.html`)**

* Big red button â†’ `POST /api/panic` with location + message.

---

## ğŸ”¹ Admin Frontend (HTML/JS by Shreya)

**Login (`login.html`)**

* Form with email + password.
* On success, store JWT in `localStorage`.

**Dashboard (`dashboard.html`)**

* Fetch `/api/stats/admin`.
* Show counts: totalTourists, activeJourneys, activePanics.

**Tourist List (`tourists.html`)**

* Fetch `/api/admin/tourists`.
* Display in `<table>`.

**Tourist Details (`tourist.html`)**

* Fetch `/api/admin/tourists/:id`.
* Show info + journeys + blockchain tx.

**Panics (`panics.html`)**

* Fetch `/api/admin/panic`.
* List all active panics with â€œResolveâ€ button â†’ `PUT /api/admin/panic/:id/resolve`.

---

## ğŸ”¹ .env.example

```
MONGO_URI=mongodb://localhost:27017/tourchain
JWT_SECRET=your_jwt_secret
BLOCKCHAIN_RPC=https://sepolia.infura.io/v3/...
PRIVATE_KEY=0xabc123...
AI_API_KEY=sk-xxxx
```

---

âœ… Now your Round-1 demo stack is:

* **Backend:** Node.js (Express + MongoDB + Hardhat)
* **Frontend:** HTML + CSS + Vanilla JS (fetch API)
* **Blockchain:** Only for journey proof (start â†’ end).
* **AI:** Triggered by backend after save.

---



awit

(await (await (new (require("ethers").Contract)("0x249E7Ef8d2983D19509e8c4b7F5556e974EBCdb9", ["function recordJourney(bytes32,uint64,uint64) external"], new (require("ethers").Wallet)("0xc9bfecb656df73252960208c134d26d6eafbaf51ba6fcb4b42f9f4c0be3fb71e", new (require("ethers").JsonRpcProvider)("http://127.0.0.1:8545")))).recordJourney(require("ethers").keccak256(require("ethers").toUtf8Bytes("aadhaar-1234")), Math.floor(new Date("2025-09-01").getTime()/1000), Math.floor(new Date("2025-09-10").getTime()/1000))).wait()).blockNumber

